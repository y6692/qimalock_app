

                    //TODO  2
//                                if (!activity.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH_LE)) {
//                                    ToastUtil.showMessageApp(context, "您的设备不支持蓝牙4.0");
//                                    popupwindow.dismiss();
//                                }
//                                BluetoothManager bluetoothManager = (BluetoothManager) activity.getSystemService(Context.BLUETOOTH_SERVICE);
//                                mBluetoothAdapter = bluetoothManager.getAdapter();
//
//                                BLEService.bluetoothAdapter = mBluetoothAdapter;
//
//                                bleService.view = context;
//                                bleService.showValue = true;
//
//                                if (mBluetoothAdapter == null) {
//                                    ToastUtil.showMessageApp(context, "获取蓝牙失败");
//                                    popupwindow.dismiss();
//                                    return;
//                                }
//                                if (!mBluetoothAdapter.isEnabled()) {
//                                    Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
//                                    startActivityForResult(enableBtIntent, 188);
//                                } else {
//                                    LogUtil.e("mf===4_1", bleid + "==="+m_nowMac);
//
//                                    bleService.connect(m_nowMac);
//
//                                    checkConnect();
//                                }


//                                ViewGroup.LayoutParams param = cb_1.getLayoutParams();
//                                param.height = 0;
//                                param.width = 0;
//
//                                cb_1.setLayoutParams(param);
//                                cb_2.setLayoutParams(param);
//                                cb_3.setLayoutParams(param);
//                                cb_4.setLayoutParams(param);
//                                cb_5.setLayoutParams(param);
//                                cb_6.setLayoutParams(param);

//                                                        cb_1.setVisibility(View.VISIBLE);
//                                                        cb_4.setVisibility(View.VISIBLE);
//                                                        cb_5.setVisibility(View.VISIBLE);
//                                                        cb_6.setVisibility(View.VISIBLE);
//                                                        cb_1.setChecked(false);
//                                                        cb_2.setChecked(false);
//                                                        cb_3.setChecked(false);
//                                                        cb_4.setChecked(false);
//                                                        cb_5.setChecked(false);
//                                                        cb_6.setChecked(false);

//                                                        cb_2.setVisibility(View.GONE);
//                                                        cb_3.setVisibility(View.GONE);
//                                                        ViewGroup.LayoutParams param = cb_2.getLayoutParams();
//                                                        param.height = 0;
//                                                        param.width = 0;
//                                                        FrameLayout.LayoutParams param = new FrameLayout.LayoutParams(0, 0);
//                                                        cb_2.setLayoutParams(param);
//                                                        cb_3.setLayoutParams(param);

//                                                        cb_2.setWidth(0);
//                                                        cb_2.setHeight(0);
//                                                        cb_3.setWidth(0);
//                                                        cb_3.setHeight(0);

//                                                        Drawable drawable = getResources().getDrawable(R.drawable.add_icon);
//                                                        drawable.setBounds(0,0,0,0);
//                                                        cb_2.setCompoundDrawables(drawable,null,null,null);
//                                                        cb_3.setCompoundDrawables(drawable,null,null,null);

//                                                        cb_3.setVisibility(View.GONE);
//                                                        param = cb_3.getLayoutParams();
//                                                        param.height = 0;
//                                                        param.width = 0;
//                                                        cb_3.setLayoutParams(param);

//                                    if(!flag){
//                                        SchoolListBean bean2 = JSON.parseObject(schools[0], SchoolListBean.class);
//
//                                        school_id = bean2.getId();
//                                        school_name = bean2.getName();
//                                        school_latitude = bean2.getLatitude();
//                                        school_longitude = bean2.getLongitude();
//                                        school_carmodel_ids = bean2.getCarmodel_ids();
//
//                                        LatLng myLocation = new LatLng(Double.parseDouble(school_latitude), Double.parseDouble(school_longitude));
//                                        leveltemp = 18f;
//                                        aMap.moveCamera(CameraUpdateFactory.newLatLngZoom(myLocation, leveltemp));
//
//                                        SharedPreferencesUrls.getInstance().putInt("school_id", school_id);
//
//                                        int[] carmodels = school_carmodel_ids;
//
//                                        LogUtil.e("sf===initHttp3", first+"==="+school_id+"==="+bean2.getId()+"==="+carmodels.length);
//
//                                        if(carmodels==null || carmodels.length==0){
//                                            cb_1.setVisibility(View.VISIBLE);
//                                            cb_2.setVisibility(View.VISIBLE);
//                                            cb_1.setChecked(false);
//                                            cb_2.setChecked(false);
//                                            cb_1.setText("只看超区");
//                                            cb_2.setText("只看坏车");
//
//                                            ll_lowpowerLayout.setVisibility(View.GONE);
//                                            ll_slowpowerLayout.setVisibility(View.GONE);
//
//                                            is_bike = false;
//                                            is_ebike = false;
//                                        }else if(carmodels!=null && carmodels.length>0){
//
//                                            LogUtil.e("sf===initHttp4", carmodels.length+"==="+carmodels[0]);
//
//                                            if(carmodels.length==1){
//
//                                                if(carmodels[0]==1){
//                                                    cb_1.setVisibility(View.VISIBLE);
//                                                    cb_2.setVisibility(View.VISIBLE);
//                                                    cb_1.setChecked(false);
//                                                    cb_2.setChecked(false);
//                                                    cb_1.setText("只看超区");
//                                                    cb_2.setText("只看坏车");
//
//                                                    ll_lowpowerLayout.setVisibility(View.GONE);
//                                                    ll_slowpowerLayout.setVisibility(View.GONE);
//
//                                                    is_bike = true;
//                                                    is_ebike = false;
//                                                }else if(carmodels[0]==2){
//
//                                                    cb_1.setVisibility(View.VISIBLE);
//                                                    cb_2.setVisibility(View.VISIBLE);
//                                                    cb_3.setVisibility(View.VISIBLE);
//                                                    cb_4.setVisibility(View.VISIBLE);
//                                                    cb_1.setChecked(false);
//                                                    cb_2.setChecked(false);
//                                                    cb_3.setChecked(false);
//                                                    cb_4.setChecked(false);
//                                                    cb_1.setText("只看超区");
//                                                    cb_2.setText("只看坏车");
//                                                    cb_3.setText("只看低电");
//                                                    cb_4.setText("只看超低电");
//
//                                                    ll_lowpowerLayout.setVisibility(View.VISIBLE);
//                                                    ll_slowpowerLayout.setVisibility(View.VISIBLE);
//
//                                                    carbatteryaction_lowpower();
//
//                                                    is_bike = false;
//                                                    is_ebike = true;
//                                                }
//                                            }else if(carmodels.length==2){
//                                                cb_1.setVisibility(View.VISIBLE);
//                                                cb_2.setVisibility(View.VISIBLE);
//                                                cb_3.setVisibility(View.VISIBLE);
//                                                cb_4.setVisibility(View.VISIBLE);
//                                                cb_5.setVisibility(View.VISIBLE);
//                                                cb_6.setVisibility(View.VISIBLE);
//                                                cb_1.setChecked(false);
//                                                cb_2.setChecked(true);
//                                                cb_3.setChecked(true);
//                                                cb_4.setChecked(false);
//                                                cb_5.setChecked(false);
//                                                cb_6.setChecked(false);
//                                                cb_1.setText("只看超区");
//                                                cb_2.setText("只看单车");
//                                                cb_3.setText("只看电单车");
//                                                cb_4.setText("只看坏车");
//                                                cb_5.setText("只看低电");
//                                                cb_6.setText("只看超低电");
//
//                                                ll_lowpowerLayout.setVisibility(View.VISIBLE);
//                                                ll_slowpowerLayout.setVisibility(View.VISIBLE);
//
//                                                carbatteryaction_lowpower();
//
//                                                is_bike = true;
//                                                is_ebike = true;
//                                            }
//
//                                        }
//                                    }

//                                int[] carmodels = null;
//                                if(SharedPreferencesUrls.getInstance().getInt("school_id", -1)==-1){
//                                    UserBean bean = JSON.parseObject(result.getData(), UserBean.class);
//
//                                    String[] schools = bean.getSchools();
//                                    if(schools!=null && schools.length>0){
//
//                                        SchoolListBean bean2 = JSON.parseObject(schools[0], SchoolListBean.class);
//
//                                        carmodels = bean2.getCarmodel_ids();
//
//                                        LogUtil.e("sf===initHttp1", schools[0]+"==="+carmodels);
//
//                                    }
//                                }else{
//                                    Gson gson = new Gson();
//
//                                    school_id = SharedPreferencesUrls.getInstance().getInt("school_id", -1);
//                                    school_name = SharedPreferencesUrls.getInstance().getString("school_name", "");
//                                    school_latitude = SharedPreferencesUrls.getInstance().getString("school_latitude", "");
//                                    school_longitude = SharedPreferencesUrls.getInstance().getString("school_longitude", "");
//                                    school_carmodel_ids = gson.fromJson(SharedPreferencesUrls.getInstance().getString("school_carmodel_ids", ""), int[].class);;
//
//                                    carmodels = school_carmodel_ids;
//
//                                    LogUtil.e("sf===initHttp2", school_id+"==="+school_name+"==="+school_latitude+"==="+school_longitude+"==="+carmodels.length);
//                                }


//                                if(carmodels==null || carmodels.length==0){
//                                    bikeLayout.setVisibility(View.GONE);
//                                    ebikeLayout.setVisibility(View.GONE);
//
//                                    switcher_bike.setChecked(false);
//                                    switcher_ebike.setChecked(false);
//                                }else if(carmodels!=null && carmodels.length>0){
//
//                                    LogUtil.e("minef===initHttp4", "===");
//
//                                    if(carmodels.length==1){
//                                        bikeLayout.setVisibility(View.GONE);
//                                        ebikeLayout.setVisibility(View.GONE);
//
//                                        if(carmodels[0]==1){
//                                            switcher_bike.setChecked(true);
//                                            switcher_ebike.setChecked(false);
//                                        }else if(carmodels[0]==2){
//                                            switcher_bike.setChecked(false);
//                                            switcher_ebike.setChecked(true);
//                                        }
//                                    }else if(carmodels.length==2){
//                                        bikeLayout.setVisibility(View.VISIBLE);
//                                        ebikeLayout.setVisibility(View.VISIBLE);
//
//                                        switcher_bike.setChecked(true);
//                                        switcher_ebike.setChecked(true);
//                                    }
//
//                                }

//                                initNearby(latitude, longitude);


//                                if (result.getFlag().equals("Success")) {
//
//
//
//                                } else {
//                                    Toast.makeText(context,result.getMsg(),Toast.LENGTH_SHORT).show();
//                                }

//                                    if("江苏理工学院".equals(schools[0]) || "泰山医学院".equals(schools[0]) || "中国矿业大学（南湖校区）".equals(schools[0]) || "河南财经政法大学".equals(schools[0])){
//                                        carmodel_id = 2;
//                                        switcher_type.setChecked(true);
//                                    }else{
//                                        carmodel_id = 1;
//                                        switcher_type.setChecked(false);
//                                    }

                                //给View传递数据
//                tvMsg.setList(list2);

//                List<String> textArray = ...;
//                tvMsg.setDataSetAdapter(new DataSetAdapter<Sentence>(list2) {
//                    @Override
//                    protected Sentence text(Sentence s) {
//                        LogUtil.e("scan===mReceiver3", s+"===");
//                        return s;
//                    }
//                });

//                tvMsg.setDataSetAdapter(new DataSetAdapter() {
//                    @Override
//                    protected String text(Object o) {
//                        LogUtil.e("scan===mReceiver3", o+"===");
//                        return null;
//                    }
//                });

//                    if(BaseApplication.getInstance().isTest()){
//                        if("40001101".equals(codenum)){
////                                                  m_nowMac = "3C:A3:08:AE:BE:24";
//                            m_nowMac = "3C:A3:08:CD:9F:47";
//                        }else if("50007528".equals(codenum)){
//
//                        }else{
//                            type = "6";
//                            m_nowMac = "A4:34:F1:7B:BF:9A";
//                        }
//                    }

//----ListView的自动循环滚动显示
autoUpdate = new Timer();
autoUpdate.schedule(new TimerTask(){
    @Override
    public void run(){
        runOnUiThread(new Runnable(){
           public void run(){
             index +=1;
             if(index >= list_review.getCount()) {
                 index = 0;

               }
              list_review.smoothScrollToPosition(index);
          }
        });
  }
}, 0,3000);

    //						if (result.getInfo().equals("2")) {
    //							CustomDialog.Builder customBuilder = new CustomDialog.Builder(context);
    //							customBuilder.setTitle("温馨提示").setMessage("该车被设为坏车，用户无法使用，请及时回收维修")
    //									.setPositiveButton("去维护", new DialogInterface.OnClickListener() {
    //										public void onClick(DialogInterface dialog, int which) {
    //											dialog.cancel();
    //
    //											MaintenanceFragment.bikeNum=codenum;
    //											MaintenanceFragment.ff=1;
    //
    //											Intent rIntent = new Intent();
    //											rIntent.putExtra("tz", "1");
    //											setResult(RESULT_OK, rIntent);
    ////												setResult(RESULT_OK);
    //
    //											scrollToFinishActivity();
    ////												MainActivity.changeTab(4);
    //
    //											if (loadingDialog != null && loadingDialog.isShowing()){
    //												loadingDialog.dismiss();
    //											}
    //										}
    //									})
    //									.setNegativeButton("开锁", new DialogInterface.OnClickListener() {
    //										public void onClick(DialogInterface dialog, int which) {
    //											dialog.cancel();
    //
    //											info(jsonObject);
    //
    //										}
    //									});
    //							customBuilder.create().show();
    //						}else{
    //							info(jsonObject);
    //						}

    //						if (result.getFlag().equals("Success")) {
    //
    //
    //						} else {
    //							LogUtil.e("lockinfo===error","==="+result.getInfo());
    //
    //							Toast.makeText(ActivityScanerCode.this,result.getMsg(),Toast.LENGTH_SHORT).show();
    //							if (loadingDialog != null && loadingDialog.isShowing()){
    //								loadingDialog.dismiss();
    //							}
    //
    //							initCamera(surfaceHolder);
    //						}


    private void upcarmap(String result){

        String access_token = SharedPreferencesUrls.getInstance().getString("access_token","");
        if (access_token == null || "".equals(access_token)){
            Toast.makeText(context,"请先登录账号",Toast.LENGTH_SHORT).show();
            UIHelper.goToAct(context, LoginActivity.class);
        }else {
            RequestParams params = new RequestParams();
            params.put("tokencode",result);
            params.put("latitude",latitude);
            params.put("longitude",longitude);
            HttpHelper.post(context, Urls.upcarmap, params, new TextHttpResponseHandler() {
                @Override
                public void onStart() {
                    if (loadingDialog != null && !loadingDialog.isShowing()) {
                        loadingDialog.setTitle("正在提交");
                        loadingDialog.show();
                    }
                }
                @Override
                public void onFailure(int statusCode, Header[] headers, String responseString, Throwable throwable) {
                    if (loadingDialog != null && loadingDialog.isShowing()){
                        loadingDialog.dismiss();
                    }
                    UIHelper.ToastError(context, throwable.toString());
                }
                @Override
                public void onSuccess(int statusCode, Header[] headers, String responseString) {
                    try {
                        ResultConsel result = JSON.parseObject(responseString, ResultConsel.class);
                        if (result.getFlag().equals("Success")) {
                            Toast.makeText(context,"恭喜您，提交成功",Toast.LENGTH_SHORT).show();
                        }else {
                            Toast.makeText(context,result.getMsg(),Toast.LENGTH_SHORT).show();
                        }
                    } catch (Exception e) {
                    }
                    if (loadingDialog != null && loadingDialog.isShowing()){
                        loadingDialog.dismiss();
                    }
                }
            });
        }
    }

    private void recycle(String result){

        String access_token = SharedPreferencesUrls.getInstance().getString("access_token","");
        if (access_token == null || "".equals(access_token)){
            Toast.makeText(context,"请先登录账号",Toast.LENGTH_SHORT).show();
            UIHelper.goToAct(context, LoginActivity.class);
        }else {
            RequestParams params = new RequestParams();
            params.put("codenum",result);
            HttpHelper.post(context, Urls.recycle, params, new TextHttpResponseHandler() {
                @Override
                public void onStart() {
                    if (loadingDialog != null && !loadingDialog.isShowing()) {
                        loadingDialog.setTitle("正在提交");
                        loadingDialog.show();
                    }
                }
                @Override
                public void onFailure(int statusCode, Header[] headers, String responseString, Throwable throwable) {
                    if (loadingDialog != null && loadingDialog.isShowing()){
                        loadingDialog.dismiss();
                    }
                    UIHelper.ToastError(context, throwable.toString());
                }
                @Override
                public void onSuccess(int statusCode, Header[] headers, String responseString) {
                    try {
                        ResultConsel result = JSON.parseObject(responseString, ResultConsel.class);
                        if (result.getFlag().equals("Success")) {
                            Toast.makeText(context,"恭喜您，回收成功",Toast.LENGTH_SHORT).show();
                        }else {
                            Toast.makeText(context,result.getMsg(),Toast.LENGTH_SHORT).show();
                        }
                    } catch (Exception e) {
                    }
                    if (loadingDialog != null && loadingDialog.isShowing()){
                        loadingDialog.dismiss();
                    }
                }
            });
        }
    }


    private void endCar(String result){

        String access_token = SharedPreferencesUrls.getInstance().getString("access_token","");
        if (access_token == null || "".equals(access_token)){
            Toast.makeText(context,"请先登录账号",Toast.LENGTH_SHORT).show();
            UIHelper.goToAct(context, LoginActivity.class);
        }else {
            RequestParams params = new RequestParams();
            params.put("tokencode",result);
            HttpHelper.post(context, Urls.endCar, params, new TextHttpResponseHandler() {
                @Override
                public void onStart() {
                    if (loadingDialog != null && !loadingDialog.isShowing()) {
                        loadingDialog.setTitle("正在提交");
                        loadingDialog.show();
                    }
                }
                @Override
                public void onFailure(int statusCode, Header[] headers, String responseString, Throwable throwable) {
                    if (loadingDialog != null && loadingDialog.isShowing()){
                        loadingDialog.dismiss();
                    }
                    UIHelper.ToastError(context, throwable.toString());
                }
                @Override
                public void onSuccess(int statusCode, Header[] headers, String responseString) {
                    try {
                        ResultConsel result = JSON.parseObject(responseString, ResultConsel.class);
                        if (result.getFlag().equals("Success")) {
                            Toast.makeText(context,"恭喜您，结束用车成功",Toast.LENGTH_SHORT).show();
                        }else {
                            Toast.makeText(context,result.getMsg(),Toast.LENGTH_SHORT).show();
                        }
                    } catch (Exception e) {
                    }
                    if (loadingDialog != null && loadingDialog.isShowing()){
                        loadingDialog.dismiss();
                    }
                }
            });
        }
    }